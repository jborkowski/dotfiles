# Prefix to Ctrl-a (like in screen)
set-option -g prefix C-a
unbind-key C-b
bind-key C-a send-prefix

# Vim-style pane navigation (used by vim-tmux-navigator)
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

# Allow vim-tmux-navigator to work properly
# (This lets tmux pass through keys if vim wants them)
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ]* +(n?vim|vimx?)$'"
bind -n C-h if-shell "$is_vim" "send-keys C-h" "select-pane -L"
bind -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
bind -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
bind -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"

# Split panes
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

# Enable mouse support (for easier pane resizing, scrolling)
set -g mouse on

# Vi mode for copy mode (enhanced navigation)
setw -g mode-keys vi

# Default terminal type for compatibility (xterm-24bit for true color)
set -g default-terminal "xterm-256color"

# xterm-24bit color support (TrueColor support)
set -g terminal-overrides 'xterm*:Tc'

# Plugin Manager (tpm)
set -g @plugin 'tmux-plugins/tpm'

# Essential Plugins:
# tmux-resurrect - Save and restore tmux sessions
set -g @plugin 'tmux-plugins/tmux-resurrect'

# tmux-continuum - Auto-save and restore sessions in the background
set -g @plugin 'tmux-plugins/tmux-continuum'

# tmux-yank - Yank text from tmux into system clipboard (with OSC 52 support)
set -g @plugin 'tmux-plugins/tmux-yank'

# Install tmux plugins
run-shell ~/.tmux/plugins/tpm/tpm

# Keybindings:
# Save session (using tmux-resurrect)
bind s run "tmux-resurrect save"

# Restore session (using tmux-resurrect)
bind r run "tmux-resurrect restore"

# Reload tmux config (Ctrl-a r)
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# Status bar configuration (with date/time)
set -g status-right "#[fg=green]#H#[default] #[fg=yellow]#(date '+%Y-%m-%d %H:%M:%S')#[default]"

# Start tmux plugin manager (tpm)
run-shell ~/.tmux/plugins/tpm/tpm

